name: Terragrunt Action Workflow GCP Prod

on:
  workflow_call:
    inputs:
      runscan:
        description: 'Enable or disable scan execution'
        required: false
        type: boolean
        default: true
      workingDirectory:
        description: "Path to the working directory"
        required: true
        type: string
      environment:
        description: "Name of the environment"
        required: true
        type: string
      tfLog:
        description: Terraform log level
        required: false
        type: string
        default: 'ERROR'
      terraformVersion:
        description: "Terraform version to install"
        required: false
        type: string
        default: '1.10.3'
      terragruntVersion:
        description: "Terragrunt version to install"
        required: false
        type: string
        default: '0.68.16'
      checkovSkipChecks:
        description: "Comma-separated list of Checkov checks to skip"
        required: false
        type: string
        default: ''
      checkovVersion:
        description: "Checkov version to install"
        required: false
        type: string
        default: '3.2.499'
      validateTerraform:
        description: "Run Terraform validation checks before Checkov scan"
        required: false
        type: boolean
        default: true
      checkFormatting:
        description: "Check Terraform file formatting"
        required: false
        type: boolean
        default: true
      failOnValidationError:
        description: "Fail the workflow if Terraform validation errors are found"
        required: false
        type: boolean
        default: false
      checkovSoftFail:
        description: "Do not fail the build if security issues are found"
        required: false
        type: boolean
        default: true
      checkovOutputFormat:
        description: "Checkov output format (cli, json, junitxml, sarif)"
        required: false
        type: string
        default: 'cli,junitxml,json'
    secrets:
      TERRAGRUNT_GITHUB_ORG_TOKEN:
        required: true
      GCP_PROD_PROJECT_ID:
        required: true
      GCP_PROD_WORKLOAD_IDENTITY_PROVIDER:
        required: true

jobs:
  terragrunt-plan:
    runs-on: ubuntu-latest
    permissions:
      contents: 'read'
      id-token: 'write'
      pull-requests: 'write'  # For Checkov comments
    env:
      TERRAGRUNT_GITHUB_ORG_TOKEN: ${{ secrets.TERRAGRUNT_GITHUB_ORG_TOKEN }}
      TF_LOG: ${{ inputs.tfLog }}
      TF_IN_AUTOMATION: 'true'
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: ${{ inputs.terraformVersion }}
          terraform_wrapper: false

      - name: Setup Terragrunt
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ“¦ Installing Terragrunt"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          TERRAGRUNT_VERSION="${{ inputs.terragruntVersion }}"
          echo "Version: ${TERRAGRUNT_VERSION}"
          
          # Download Terragrunt binary
          wget -q https://github.com/gruntwork-io/terragrunt/releases/download/v${TERRAGRUNT_VERSION}/terragrunt_linux_amd64 -O terragrunt
          
          # Make executable
          chmod +x terragrunt
          
          # Move to PATH
          sudo mv terragrunt /usr/local/bin/terragrunt
          
          # Verify installation
          echo ""
          echo "âœ… Terragrunt Installation:"
          terragrunt --version
          echo ""
          echo "âœ… Terraform Installation:"
          terraform --version
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: GCP Auth
        uses: AjitPunchhiInutive/gh-actions-library/.github/actions/gcp/auth@main
        with:
          project_id: ${{ secrets.GCP_PROD_PROJECT_ID }}
          workload_identity_provider: ${{ secrets.GCP_PROD_WORKLOAD_IDENTITY_PROVIDER }}

      - name: Debug - Check Directory Structure
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ” Directory Structure Analysis"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "Current Directory: $(pwd)"
          echo ""
          echo "Working Directory Input: ${{ inputs.workingDirectory }}"
          echo ""
          echo "Directory Contents:"
          ls -la ${{ inputs.workingDirectory }} 2>/dev/null || echo "âŒ Directory not found"
          echo ""
          echo "Terragrunt Files:"
          find . -name "terragrunt.hcl" -type f 2>/dev/null || echo "No terragrunt.hcl files found"
          echo ""
          echo "Terraform Files:"
          find . -name "*.tf" -type f ! -path "*/.terragrunt-cache/*" | head -10 || echo "No .tf files found"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Terragrunt Init
        working-directory: ${{ inputs.workingDirectory }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ”§ Terragrunt Init"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "Directory: $(pwd)"
          echo ""
          terragrunt init -reconfigure
          echo ""
          echo "âœ… Initialization completed"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Terragrunt Validate
        working-directory: ${{ inputs.workingDirectory }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "âœ… Terragrunt Validate"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          terragrunt validate
          echo ""
          echo "âœ… Validation passed"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Terragrunt Format Check
        working-directory: ${{ inputs.workingDirectory }}
        continue-on-error: true
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ“ Terragrunt Format Check"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          echo "Checking Terragrunt HCL files..."
          terragrunt hclfmt --terragrunt-check || echo "âš ï¸ HCL format issues found"
          
          echo ""
          echo "Checking Terraform files..."
          terraform fmt -check -recursive || echo "âš ï¸ TF format issues found"
          
          echo ""
          echo "â„¹ï¸ Format check completed (non-blocking)"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Terragrunt Plan
        working-directory: ${{ inputs.workingDirectory }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ“‹ Terragrunt Plan"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "Directory: $(pwd)"
          echo "Environment: ${{ inputs.environment }}"
          echo ""
          
          # Use absolute path for plan file to avoid cache directory issues
          PLAN_FILE="$(pwd)/tfplan.out"
          echo "Plan file path: ${PLAN_FILE}"
          echo ""
          
          # Run plan with absolute path
          terragrunt plan -out="${PLAN_FILE}"
          
          echo ""
          # Verify plan file was created
          if [ -f "${PLAN_FILE}" ]; then
            echo "âœ… Plan file created: $(ls -lh ${PLAN_FILE} | awk '{print $9, $5}')"
          else
            echo "âŒ Error: Plan file not created at ${PLAN_FILE}"
            echo ""
            echo "Checking for plan files in cache directories..."
            find . -name "tfplan.out" -type f
            exit 1
          fi
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Convert Plan to JSON for Checkov
        working-directory: ${{ inputs.workingDirectory }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ”„ Converting Plan to JSON"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          PLAN_FILE="$(pwd)/tfplan.out"
          JSON_PLAN_FILE="$(pwd)/tfplan.json"
          
          echo "Source: ${PLAN_FILE}"
          echo "Target: ${JSON_PLAN_FILE}"
          echo ""
          
          terragrunt show -json "${PLAN_FILE}" > "${JSON_PLAN_FILE}"
          
          if [ -f "${JSON_PLAN_FILE}" ]; then
            echo "âœ… JSON plan file created: $(ls -lh ${JSON_PLAN_FILE} | awk '{print $9, $5}')"
          else
            echo "âŒ Error: JSON plan file not created"
            exit 1
          fi
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Run Checkov Security Scan with Terraform Validation
        if: inputs.runscan == true
        uses: AjitPunchhiInutive/gh-actions-library/.github/actions/checkov@main
        with:
          # Checkov configuration
          version: ${{ inputs.checkovVersion }}
          run-scan: ${{ inputs.runscan }}
          workingDirectory: ${{ inputs.workingDirectory }}
          checkovSkipChecks: ${{ inputs.checkovSkipChecks }}
          scan-terragrunt-cache: 'true'
          output-format: ${{ inputs.checkovOutputFormat }}
          framework: 'terraform'
          soft-fail: ${{ inputs.checkovSoftFail }}
          
          # Terraform validation configuration
          validate-terraform: ${{ inputs.validateTerraform }}
          terraform-version: ${{ inputs.terraformVersion }}
          check-formatting: ${{ inputs.checkFormatting }}
          fail-on-validation-error: ${{ inputs.failOnValidationError }}

      - name: Upload Terraform Plan
        uses: actions/upload-artifact@v4
        with:
          name: tf-plan-${{ inputs.environment }}
          path: |
            ${{ inputs.workingDirectory }}/tfplan.out
            ${{ inputs.workingDirectory }}/tfplan.json
          retention-days: 30
          if-no-files-found: error

      - name: Plan Summary
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" >> $GITHUB_STEP_SUMMARY
          echo "## ðŸ“‹ Terragrunt Plan Summary" >> $GITHUB_STEP_SUMMARY
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Property | Value |" >> $GITHUB_STEP_SUMMARY
          echo "|----------|-------|" >> $GITHUB_STEP_SUMMARY
          echo "| **Environment** | \`${{ inputs.environment }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Working Directory** | \`${{ inputs.workingDirectory }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Terraform Version** | \`${{ inputs.terraformVersion }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Terragrunt Version** | \`${{ inputs.terragruntVersion }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Security Scan** | \`${{ inputs.runscan }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… Plan phase completed successfully" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

  manual-approval:
    needs: terragrunt-plan
    runs-on: ubuntu-latest
    environment: 
      name: prod
      url: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
    steps:
      - name: Manual Approval Required
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "â¸ï¸  Waiting for Manual Approval"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          echo "Environment: ${{ inputs.environment }}"
          echo "Working Directory: ${{ inputs.workingDirectory }}"
          echo ""
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "âœ… Approval granted - proceeding to apply"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

  terragrunt-apply:
    needs: manual-approval
    environment: prod
    runs-on: ubuntu-latest
    permissions:
      contents: 'read'
      id-token: 'write'
    env:
      TERRAGRUNT_GITHUB_ORG_TOKEN: ${{ secrets.TERRAGRUNT_GITHUB_ORG_TOKEN }}
      TF_LOG: ${{ inputs.tfLog }}
      TF_IN_AUTOMATION: 'true'
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: ${{ inputs.terraformVersion }}
          terraform_wrapper: false

      - name: Setup Terragrunt
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ“¦ Installing Terragrunt"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          TERRAGRUNT_VERSION="${{ inputs.terragruntVersion }}"
          echo "Version: ${TERRAGRUNT_VERSION}"
          echo ""
          
          wget -q https://github.com/gruntwork-io/terragrunt/releases/download/v${TERRAGRUNT_VERSION}/terragrunt_linux_amd64 -O terragrunt
          chmod +x terragrunt
          sudo mv terragrunt /usr/local/bin/terragrunt
          
          echo "âœ… Terragrunt Installation:"
          terragrunt --version
          echo ""
          echo "âœ… Terraform Installation:"
          terraform --version
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: GCP Auth
        uses: AjitPunchhiInutive/gh-actions-library/.github/actions/gcp/auth@main
        with:
          project_id: ${{ secrets.GCP_PROD_PROJECT_ID }}
          workload_identity_provider: ${{ secrets.GCP_PROD_WORKLOAD_IDENTITY_PROVIDER }}
      
      - name: Download Terraform Plan
        uses: actions/download-artifact@v4
        with:
          name: tf-plan-${{ inputs.environment }}
          path: ${{ inputs.workingDirectory }}

      - name: Verify Plan File
        working-directory: ${{ inputs.workingDirectory }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ” Verifying Plan File"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "Directory: $(pwd)"
          echo ""
          echo "Directory contents:"
          ls -la
          echo ""
          
          if [ -f "tfplan.out" ]; then
            echo "âœ… Plan file found: $(ls -lh tfplan.out | awk '{print $9, $5}')"
          else
            echo "âŒ Error: Plan file not found!"
            exit 1
          fi
          
          if [ -f "tfplan.json" ]; then
            echo "âœ… JSON plan file found: $(ls -lh tfplan.json | awk '{print $9, $5}')"
          fi
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Terragrunt Init (for apply)
        working-directory: ${{ inputs.workingDirectory }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ”§ Terragrunt Init (for apply)"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          terragrunt init -reconfigure
          echo ""
          echo "âœ… Initialization completed"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Terragrunt Apply
        if: github.ref == 'refs/heads/main'
        working-directory: ${{ inputs.workingDirectory }}
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸš€ Terragrunt Apply"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "Directory: $(pwd)"
          echo "Environment: ${{ inputs.environment }}"
          echo "Branch: ${{ github.ref }}"
          echo ""
          
          # Use absolute path for apply
          PLAN_FILE="$(pwd)/tfplan.out"
          echo "Applying plan: ${PLAN_FILE}"
          echo ""
          
          # Apply the plan file
          terragrunt apply "${PLAN_FILE}"
          
          echo ""
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "âœ… Apply completed successfully"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: Apply Summary
        if: success()
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" >> $GITHUB_STEP_SUMMARY
          echo "## âœ… Terragrunt Apply Summary" >> $GITHUB_STEP_SUMMARY
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Property | Value |" >> $GITHUB_STEP_SUMMARY
          echo "|----------|-------|" >> $GITHUB_STEP_SUMMARY
          echo "| **Environment** | \`${{ inputs.environment }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Working Directory** | \`${{ inputs.workingDirectory }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Applied By** | \`${{ github.actor }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Commit SHA** | \`${{ github.sha }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Workflow Run** | [#${{ github.run_number }}](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}) |" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸŽ‰ Infrastructure changes have been successfully applied to production!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

      - name: Notify on Failure
        if: failure()
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" >> $GITHUB_STEP_SUMMARY
          echo "## âŒ Terragrunt Apply Failed" >> $GITHUB_STEP_SUMMARY
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âš ï¸ The apply step failed. Please review the logs and take appropriate action." >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Environment:** \`${{ inputs.environment }}\`" >> $GITHUB_STEP_SUMMARY
          echo "**Working Directory:** \`${{ inputs.workingDirectory }}\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY